# 算术锁屏 (ArithScreenLock)

一个Android锁屏应用程序，通过解答数学题来解锁屏幕。

## 功能特性

### 1. 数学题解锁
- 解锁时需要回答若干道50以内的加减法题目（默认6道题）
- 只有全部答对才能解锁屏幕
- 答错会重新生成题目

### 2. 控制台设置
- 需要密码（123456）才能进入控制台
- 可设置参数：
  - **题目数量**：1-10道题
  - **数字范围**：10以内、20以内、50以内、100以内
  - **运算类型**：加法、减法、乘法、除法（可多选）
  - **自动锁定时长**：解锁后多少分钟自动重新锁定

### 3. 家长模式
- 锁屏界面右上角有家长模式按钮
- 点击后弹出PIN码输入窗口
- PIN码规则：
  - 显示4位提示码
  - 根据第一位数字从第N位开始循环输入
  - 例：提示码1532，从第1位开始输入，答案是1532
  - 例：提示码2351，从第2位开始输入，答案是3512
- **家长模式有效期为30分钟**
- 超过30分钟后自动失效，需重新验证PIN码

### 4. 锁屏服务
- 后台服务监听屏幕开关事件
- 屏幕关闭或开启时自动显示锁屏界面
- 支持开机自启动
- 前台服务保证稳定运行

### 5. 安全防护机制 🔒
- **多层防绕过保护**：防止用户通过返回键、Home键等方式绕过锁屏
- **Activity生命周期监控**：自动检测和恢复被关闭的锁屏界面
- **后台监控服务**：实时监控锁屏状态，自动恢复异常
- **设备管理员支持**：可选的设备管理员权限，提供系统级保护
- **系统按键拦截**：禁用返回键、菜单键等系统按键
- **窗口标志增强**：全屏显示，覆盖系统UI

## 安装和使用

1. **权限设置**
   - 首次使用需要授予"显示在其他应用上层"权限
   - 建议启用"设备管理员"权限以获得更强的安全保护
   - 应用会自动引导用户完成权限设置

2. **启动服务**
   - 在主界面点击"启动锁屏服务"
   - 服务启动后会在通知栏显示运行状态

3. **配置设置**
   - 点击"设置"按钮，输入控制台密码
   - 根据需要调整题目数量、数字范围等参数

4. **解锁屏幕**
   - 屏幕锁定时会显示数学题
   - 输入正确答案后点击"提交"解锁
   - 或使用右上角家长模式快速解锁

## 技术实现

- **开发语言**：Kotlin
- **最低Android版本**：Android 7.0 (API 24)
- **目标Android版本**：Android 14 (API 34)
- **架构组件**：
  - Service：后台锁屏服务
  - BroadcastReceiver：屏幕事件监听
  - SharedPreferences：设置数据存储
  - 系统窗口权限：显示锁屏界面

## 项目结构

```
app/src/main/java/com/example/arithscreenlock/
├── MainActivity.kt              # 主界面
├── LockScreenActivity.kt        # 锁屏界面
├── SettingsActivity.kt          # 设置界面
├── LockScreenService.kt         # 锁屏服务
├── BootReceiver.kt             # 开机广播接收器
├── MathQuestion.kt             # 数学题生成器
└── LockScreenPreferences.kt    # 设置数据管理

app/src/main/res/
├── layout/                     # 界面布局文件
├── values/                     # 字符串和样式资源
└── drawable/                   # 图标和背景资源
```

## 注意事项

1. 应用需要系统窗口权限才能正常工作
2. 部分手机厂商可能需要额外的自启动权限设置
3. 建议在设置中将应用加入白名单，防止被系统清理
4. 家长模式PIN码每次都会重新生成，确保安全性

## 开发和编译

1. 使用Android Studio打开项目
2. 确保Android SDK版本为34或以上
3. 连接Android设备或启动模拟器
4. 点击Run按钮编译并安装应用

## 许可证

本项目仅用于学习和演示目的。